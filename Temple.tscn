[gd_scene load_steps=38 format=3 uid="uid://b8l5mnur7ugi1"]

[ext_resource type="Script" path="res://DudeController.cs" id="1_ap5d1"]
[ext_resource type="Script" path="res://TempleState.cs" id="1_hpo4a"]
[ext_resource type="Texture2D" uid="uid://dvv7glpcyrlbd" path="res://bowling-lane-first-try.png" id="3_46ni7"]
[ext_resource type="Script" path="res://StartBowlingHandler.cs" id="5_68h4b"]
[ext_resource type="PackedScene" uid="uid://6qw3gie53svf" path="res://Pins/SimpleCandlePin/SimpleCandlePins.tscn" id="6_buwsq"]
[ext_resource type="Script" path="res://PlayerViewManager.cs" id="6_ql2ml"]
[ext_resource type="Script" path="res://BowlingGameManager.cs" id="7_rl7pp"]
[ext_resource type="PackedScene" uid="uid://be5qpiblt04st" path="res://BowlingBall.tscn" id="8_ncw30"]
[ext_resource type="PackedScene" uid="uid://cbtcp1ld8crwc" path="res://UI/PauseMenu/PauseMenu.tscn" id="9_gpxng"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_rhnba"]
sky_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)
ground_horizon_color = Color(0.64625, 0.65575, 0.67075, 1)

[sub_resource type="Sky" id="Sky_564qw"]
sky_material = SubResource("ProceduralSkyMaterial_rhnba")

[sub_resource type="Environment" id="Environment_wulwk"]
background_mode = 2
sky = SubResource("Sky_564qw")
tonemap_mode = 2
glow_enabled = true

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_0vrco"]
height = 1.8

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_fqv2w"]
friction = 0.05

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_e2fno"]
albedo_texture = ExtResource("3_46ni7")

[sub_resource type="PlaneMesh" id="PlaneMesh_qvwig"]
lightmap_size_hint = Vector2i(97, 7)
material = SubResource("StandardMaterial3D_e2fno")
size = Vector2(19.16, 1.064)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_qespb"]
points = PackedVector3Array(-9.58, 0, -0.532, -9.58, 0, 0.531896, 9.58, 0, -0.532, 9.58, 0, 0.531896)

[sub_resource type="PlaneMesh" id="PlaneMesh_j0wl5"]
size = Vector2(19.16, 0.228)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_duvm3"]
points = PackedVector3Array(-9.58, 0, -0.114, -9.58, 0, 0.114, 9.58, 0, -0.114, 9.58, 0, 0.114)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_b0tfm"]
points = PackedVector3Array(-9.58, 0, -0.114, -9.58, 0, 0.114, 9.58, 0, -0.114, 9.58, 0, 0.114)

[sub_resource type="PlaneMesh" id="PlaneMesh_t7vb6"]
size = Vector2(19.16, 0.15)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_5xq2x"]
points = PackedVector3Array(-9.58, 0, -0.075, -9.58, 0, 0.075, 9.58, 0, -0.075, 9.58, 0, 0.075)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_ussfq"]
points = PackedVector3Array(-9.58, 0, -0.075, -9.58, 0, 0.075, 9.58, 0, -0.075, 9.58, 0, 0.075)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_n1eht"]
points = PackedVector3Array(-9.58, 0, -0.075, -9.58, 0, 0.075, 9.58, 0, -0.075, 9.58, 0, 0.075)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_cfua8"]
points = PackedVector3Array(-9.58, 0, -0.075, -9.58, 0, 0.075, 9.58, 0, -0.075, 9.58, 0, 0.075)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_tipaq"]
albedo_color = Color(0.301961, 0.301961, 0.219608, 1)

[sub_resource type="PlaneMesh" id="PlaneMesh_8kvq3"]
material = SubResource("StandardMaterial3D_tipaq")
size = Vector2(50, 50)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_qng8h"]
points = PackedVector3Array(-25, 0, -25, -25, 0, 25, 25, 0, -25, 25, 0, 25)

[sub_resource type="BoxShape3D" id="BoxShape3D_0dj8r"]
size = Vector3(2, 2, 2)

[sub_resource type="ViewportTexture" id="ViewportTexture_7idmr"]
viewport_path = NodePath("BowlingGame/EndLineViewport")

[sub_resource type="BoxMesh" id="BoxMesh_rby5l"]
size = Vector3(0.5, 1, 1.7)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_soloo"]
points = PackedVector3Array(-0.25, -0.5, -0.85, 0.25, -0.5, -0.85, -0.25, -0.5, 0.85, -0.25, 0.5, -0.85, 0.25, 0.5, -0.85, 0.25, -0.5, 0.85, -0.25, 0.5, 0.85, 0.25, 0.5, 0.85)

[sub_resource type="BoxMesh" id="BoxMesh_nchpp"]
size = Vector3(2, 1, 0.25)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_4a07v"]
points = PackedVector3Array(1, 0.5, 0.125, 1, 0.5, -0.125, -1, 0.5, 0.125, 1, -0.5, 0.125, 1, -0.5, -0.125, -1, 0.5, -0.125, -1, -0.5, 0.125, -1, -0.5, -0.125)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_jdq61"]
points = PackedVector3Array(1, 0.5, 0.125, 1, 0.5, -0.125, -1, 0.5, 0.125, 1, -0.5, 0.125, 1, -0.5, -0.125, -1, 0.5, -0.125, -1, -0.5, 0.125, -1, -0.5, -0.125)

[sub_resource type="BoxMesh" id="BoxMesh_juuuf"]
size = Vector3(2, 0.5, 2.15)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_xh1hp"]
points = PackedVector3Array(1, 0.25, 1.075, 1, -0.25, 1.075, 1, 0.25, -1.075, -1, 0.25, 1.075, -1, -0.25, 1.075, 1, -0.25, -1.075, -1, 0.25, -1.075, -1, -0.25, -1.075)

[node name="Temple" type="Node3D"]
script = ExtResource("1_hpo4a")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_wulwk")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866025, -0.433013, 0.25, 0, 0.5, 0.866025, -0.5, 0.75, -0.433013, 0, 0, 0)
shadow_enabled = true

[node name="Dude" type="CharacterBody3D" parent="." node_paths=PackedStringArray("DudeFace", "DudeHand", "InteractUI")]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, -23.4157, 0, 0)
script = ExtResource("1_ap5d1")
_lookAroundSensitivity = 0.3
DudeFace = NodePath("DudeFaceCamera")
DudeHand = NodePath("DudeFaceCamera/InteractRaycast")
InteractUI = NodePath("InteractLabel")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Dude"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.22154, 0)
shape = SubResource("CapsuleShape3D_0vrco")

[node name="DudeFaceCamera" type="Camera3D" parent="Dude"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.9119, 0)

[node name="InteractRaycast" type="RayCast3D" parent="Dude/DudeFaceCamera"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0)
target_position = Vector3(0, -2, 0)
collision_mask = 2048
collide_with_areas = true
collide_with_bodies = false

[node name="InteractLabel" type="Label" parent="Dude"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -20.0
offset_top = -11.5
offset_right = 20.0
offset_bottom = 11.5
grow_horizontal = 2
grow_vertical = 2
size_flags_horizontal = 4
text = "Press E to interact"
metadata/_edit_use_anchors_ = true

[node name="BowlingLane" type="StaticBody3D" parent="."]
physics_material_override = SubResource("PhysicsMaterial_fqv2w")

[node name="BowlingLaneMesh" type="MeshInstance3D" parent="BowlingLane"]
mesh = SubResource("PlaneMesh_qvwig")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="BowlingLane"]
shape = SubResource("ConvexPolygonShape3D_qespb")

[node name="Borders" type="Node3D" parent="BowlingLane"]

[node name="StaticBody3D" type="StaticBody3D" parent="BowlingLane/Borders"]

[node name="MeshInstance3D" type="MeshInstance3D" parent="BowlingLane/Borders/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.15, 0.646)
mesh = SubResource("PlaneMesh_j0wl5")
skeleton = NodePath("../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="BowlingLane/Borders/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.15, 0.646)
shape = SubResource("ConvexPolygonShape3D_duvm3")

[node name="StaticBody3D2" type="StaticBody3D" parent="BowlingLane/Borders"]

[node name="MeshInstance3D2" type="MeshInstance3D" parent="BowlingLane/Borders/StaticBody3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.15, -0.646)
mesh = SubResource("PlaneMesh_j0wl5")
skeleton = NodePath("")

[node name="CollisionShape3D2" type="CollisionShape3D" parent="BowlingLane/Borders/StaticBody3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.15, -0.646)
shape = SubResource("ConvexPolygonShape3D_b0tfm")

[node name="StaticBody3D3" type="StaticBody3D" parent="BowlingLane/Borders"]

[node name="MeshInstance3D3" type="MeshInstance3D" parent="BowlingLane/Borders/StaticBody3D3"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, -0.075, 0.532)
mesh = SubResource("PlaneMesh_t7vb6")
skeleton = NodePath("../..")

[node name="CollisionShape3D3" type="CollisionShape3D" parent="BowlingLane/Borders/StaticBody3D3"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, -0.075, 0.532)
shape = SubResource("ConvexPolygonShape3D_5xq2x")

[node name="StaticBody3D4" type="StaticBody3D" parent="BowlingLane/Borders"]

[node name="MeshInstance3D5" type="MeshInstance3D" parent="BowlingLane/Borders/StaticBody3D4"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, -0.075, -0.76)
mesh = SubResource("PlaneMesh_t7vb6")
skeleton = NodePath("../..")

[node name="CollisionShape3D4" type="CollisionShape3D" parent="BowlingLane/Borders/StaticBody3D4"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, -0.075, -0.76)
shape = SubResource("ConvexPolygonShape3D_ussfq")

[node name="StaticBody3D5" type="StaticBody3D" parent="BowlingLane/Borders"]

[node name="MeshInstance3D4" type="MeshInstance3D" parent="BowlingLane/Borders/StaticBody3D5"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, -0.075, -0.532)
mesh = SubResource("PlaneMesh_t7vb6")
skeleton = NodePath("../..")

[node name="CollisionShape3D5" type="CollisionShape3D" parent="BowlingLane/Borders/StaticBody3D5"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, -0.075, -0.532)
shape = SubResource("ConvexPolygonShape3D_n1eht")

[node name="StaticBody3D6" type="StaticBody3D" parent="BowlingLane/Borders"]

[node name="MeshInstance3D6" type="MeshInstance3D" parent="BowlingLane/Borders/StaticBody3D6"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, -0.075, 0.76)
mesh = SubResource("PlaneMesh_t7vb6")
skeleton = NodePath("../..")

[node name="CollisionShape3D6" type="CollisionShape3D" parent="BowlingLane/Borders/StaticBody3D6"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, -0.075, 0.76)
shape = SubResource("ConvexPolygonShape3D_cfua8")

[node name="JustFloor" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -13, 0, 0)

[node name="MeshInstance3D" type="MeshInstance3D" parent="JustFloor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -22, 0, 0)
mesh = SubResource("PlaneMesh_8kvq3")

[node name="CollisionShape3D" type="CollisionShape3D" parent="JustFloor"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -22, 0, 0)
shape = SubResource("ConvexPolygonShape3D_qng8h")

[node name="StartGameArea" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 1, 0)
collision_layer = 2048
collision_mask = 2048
script = ExtResource("5_68h4b")

[node name="StartGameTrigger" type="CollisionShape3D" parent="StartGameArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0)
shape = SubResource("BoxShape3D_0dj8r")

[node name="PlayerViewManager" type="Node" parent="." node_paths=PackedStringArray("DudeCamera", "BowlingCamera")]
editor_description = "Used to change player view by managing several cameras."
script = ExtResource("6_ql2ml")
DudeCamera = NodePath("../Dude/DudeFaceCamera")
BowlingCamera = NodePath("../BowlingGame/BowlingCamera")

[node name="BowlingGame" type="Node3D" parent="." node_paths=PackedStringArray("SpawnBallLocation", "SpawnPinsLocation", "PowerMeterUI", "EndLineView")]
script = ExtResource("7_rl7pp")
BowlingBallScene = ExtResource("8_ncw30")
SpawnBallLocation = NodePath("BallSpawnLocation")
BowlingPinsScene = ExtResource("6_buwsq")
SpawnPinsLocation = NodePath("PinsSpawnLocation")
PowerMeterUI = NodePath("PowerMeter")
EndLineView = NodePath("EndLineView")
_moveBallSensitivity = 0.2

[node name="BallSpawnLocation" type="Node3D" parent="BowlingGame"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.94376, 0.663973, 0)

[node name="PinsSpawnLocation" type="Node3D" parent="BowlingGame"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 9.145, 0, 0)

[node name="BowlingCamera" type="Camera3D" parent="BowlingGame"]
transform = Transform3D(-4.2222e-08, 0.258819, -0.965926, 1.13133e-08, 0.965926, 0.258819, 1, 4.61853e-14, -4.37114e-08, -11.5495, 2, 0)

[node name="PowerMeter" type="VBoxContainer" parent="BowlingGame"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = 166.0
offset_top = -143.5
offset_right = 308.0
offset_bottom = 143.5
grow_horizontal = 2
grow_vertical = 2
alignment = 2

[node name="PowerMeterScale" type="VBoxContainer" parent="BowlingGame/PowerMeter"]
layout_mode = 2
alignment = 2

[node name="ColorRect" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(0.745098, 0, 0.745098, 1)

[node name="ColorRect2" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(0.909804, 0, 0.909804, 1)

[node name="ColorRect3" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(1, 0.0705882, 1, 1)

[node name="ColorRect4" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(1, 0.478431, 0.988235, 1)

[node name="ColorRect5" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(1, 0.623529, 0.984314, 1)

[node name="ColorRect6" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(1, 0.745098, 0.984314, 1)

[node name="ColorRect7" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(1, 0.827451, 0.988235, 1)

[node name="ColorRect8" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2
color = Color(1, 0.890196, 0.992157, 1)

[node name="ColorRect9" type="ColorRect" parent="BowlingGame/PowerMeter/PowerMeterScale"]
custom_minimum_size = Vector2(0, 25)
layout_mode = 2

[node name="Label" type="Label" parent="BowlingGame/PowerMeter"]
layout_mode = 2
text = "Throw power"
horizontal_alignment = 1

[node name="EndLineView" type="TextureRect" parent="BowlingGame"]
offset_right = 512.0
offset_bottom = 512.0
texture = SubResource("ViewportTexture_7idmr")

[node name="EndLineViewport" type="SubViewport" parent="BowlingGame"]

[node name="EndLineCamera" type="Camera3D" parent="BowlingGame/EndLineViewport"]
transform = Transform3D(-4.37114e-08, 0.258819, -0.965926, 0, 0.965926, 0.258819, 1, 1.13133e-08, -4.2222e-08, 7.54898, 0.821305, 0)

[node name="PinsMachine" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10.4868, 0, 0)

[node name="StaticBody3D" type="StaticBody3D" parent="PinsMachine"]

[node name="PinsMachineMesh" type="MeshInstance3D" parent="PinsMachine/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.127525, 0, 0)
mesh = SubResource("BoxMesh_rby5l")
skeleton = NodePath("../../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PinsMachine/StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.127525, 0, 0)
shape = SubResource("ConvexPolygonShape3D_soloo")

[node name="StaticBody3D2" type="StaticBody3D" parent="PinsMachine"]

[node name="PinsMachineMesh2" type="MeshInstance3D" parent="PinsMachine/StaticBody3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.624422, 0, 0.94674)
mesh = SubResource("BoxMesh_nchpp")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PinsMachine/StaticBody3D2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.624422, 0, 0.94674)
shape = SubResource("ConvexPolygonShape3D_4a07v")

[node name="StaticBody3D3" type="StaticBody3D" parent="PinsMachine"]

[node name="PinsMachineMesh3" type="MeshInstance3D" parent="PinsMachine/StaticBody3D3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.624422, 0, -0.945516)
mesh = SubResource("BoxMesh_nchpp")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PinsMachine/StaticBody3D3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.624422, 0, -0.945516)
shape = SubResource("ConvexPolygonShape3D_jdq61")

[node name="StaticBody3D4" type="StaticBody3D" parent="PinsMachine"]

[node name="PinsMachineMesh4" type="MeshInstance3D" parent="PinsMachine/StaticBody3D4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.625377, 0.75326, 0)
mesh = SubResource("BoxMesh_juuuf")
skeleton = NodePath("../..")

[node name="CollisionShape3D" type="CollisionShape3D" parent="PinsMachine/StaticBody3D4"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.625377, 0.75326, 0)
shape = SubResource("ConvexPolygonShape3D_xh1hp")

[node name="PauseMenu" parent="." instance=ExtResource("9_gpxng")]

[connection signal="GameModeChanged" from="." to="Dude" method="OnGameModeChanged"]
[connection signal="GameModeChanged" from="." to="PlayerViewManager" method="ChangeCameraForGameMode"]
[connection signal="GameModeChanged" from="." to="BowlingGame" method="OnGameModeChanged"]
[connection signal="StartBowlingTriggered" from="StartGameArea" to="." method="StartBowling"]
